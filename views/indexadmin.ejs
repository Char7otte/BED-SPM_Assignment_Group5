<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('./partials/head') %>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin</title>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <link rel="stylesheet" href="/stylesheets/bulma.min.css">
    <script src="/javascripts/script.js"></script>
    
</head>
<style>
    body {
                font-family: Arial, sans-serif;
                background-image: linear-gradient(135deg, #f5f7fa 0%, #8ea2c2 100%);
                background-size: cover;
                color: #333;
                text-align: center;
            }
    .row1 {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
    }
    .is-half{
        margin-top: 30px;
    }

    @media (max-width: 576px) {
        .row1 {
            flex-direction: column;
            align-items: center;
        }
        .container {
            padding: 0 15px;
            width: 80%;
        }
    }

</style>
<body>
<%- include('partials/navbar') %>
<div class="container">
    <div class="columns is-centered">
        <div class="column is-half">
            <h1 class="title">ğŸ‘©ğŸ½â€ğŸ’»Welcome to the Admin DashboardğŸ‘¨ğŸ½â€ğŸ’»</h1>
            <p class="subtitle">Manage your application effectively.</p>
            <p>If you are not an admin, please log out and return to the appropriate page.</p>
        </div>
    </div>
    <div class="row1">
        <div class="column is-one-quarter">
            <div class="box" style="height: 220px; display: flex; flex-direction: column; justify-content: space-between;">
                <h2 class="title is-4">ğŸ•µğŸ½User Management</h2>
                <p>Manage users, view statistics, and handle user accounts.</p>
                <a href="/user" class="button is-link">Manage Users</a>
            </div>
        </div>
        <div class="column is-one-quarter">
            <div class="box" style="height: 220px; display: flex; flex-direction: column; justify-content: space-between;">
                <h2 class="title is-4">ğŸª§Alert Management</h2>
                <p>Manage alerts, notifications, and user messages.</p>
                <a href="/alert" class="button is-link">Manage Alerts</a>
            </div>
        </div>
        <div class="column is-one-quarter">
            <div class="box" style="height: 220px; display: flex; flex-direction: column; justify-content: space-between;">
                <h2 class="title is-4">ğŸ“¬Feedback</h2>
                <p>View and manage user feedback and suggestions.</p>
                <a href="/feedback-admin" class="button is-link">View Feedback</a>
            </div>
        </div>
        <div class="column is-one-quarter">
            <div class="box" style="height: 220px; display: flex; flex-direction: column; justify-content: space-between;">
                <h2 class="title is-4">ğŸ”’Coming SoonğŸ”œ</h2>
                <p>This feature is under development and will be available soon.</p>
                <button class="button is-link" disabled>Coming Soon</button>
            </div>
        </div>
    </div>

</body>
<%- include('./partials/footer') %>
<script>
    function decodeJwtPayload(token) {
    const jwt = token.split(" ")[1]; // remove 'Bearer'
    const payloadBase64 = jwt.split(".")[1]; // get payload
    const payloadJson = atob(payloadBase64); // decode base64
    return JSON.parse(payloadJson); // parse to JSON
}

function isTokenExpired(token) {
    const decoded = decodeJwtPayload(token);
    if (!decoded || !decoded.exp) return true;
    return decoded.exp < Date.now() / 1000;
}

const token = localStorage.getItem('token');
console.log("Token from localStorage:", token);
if (!token || isTokenExpired(token)) {
    localStorage.removeItem('token');
    window.location.href = '/login'; // Redirect to login
}
// Check for token in cookies if not found in localStorage
if (!localStorage.getItem('token')) {
    const match = document.cookie.match(/(?:^|;\s*)token=([^;]*)/);
    if (match) {
        localStorage.setItem('token', decodeURIComponent(match[1]));
    } else {
        window.location.href = "/login";
    }
}
</script>
</html>
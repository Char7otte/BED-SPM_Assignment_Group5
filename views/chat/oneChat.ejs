<!DOCTYPE html>
<html lang="en">
    <head>
        <%- include("../partials/head")%>
        <link rel="stylesheet" href="/css/chat/chatStyles.css" />
        <title>Viewing chat <%= chatID %></title>
        <%= %>
    </head>
    <body>
        <%- include("../partials/navbar")%>
        <main>
            <h1 class="title sticky-header has-text-centered has-background-dark mb-5"><%= title %></h1>
            <div class="container">
                <div class="columns">
                    <div class="column"></div>
                    <div class="column is-two-thirds">
                        <section class="messages">
                            <section class="mb-4">
                                <form action="/chats" method="GET" class="is-inline-block">
                                    <button type="submit" class="button is-outlined is-light">
                                        <span class="icon button-icon">
                                            <i class="fa-solid fa-arrow-left"></i>
                                        </span>
                                        Return
                                    </button>
                                </form>
                                <form action="/chats/status/<%=  chatID %>?_method=PATCH" method="POST" class="is-inline-block">
                                    <button type="submit" class="button is-outlined is-primary">
                                        <span class="icon button-icon">
                                            <i class="fa-solid fa-check"></i>
                                        </span>
                                        Mark as answered
                                    </button>
                                </form>
                            </section>
                            <div class="fixed-grid has-1-cols">
                                <div class="grid">
                                    <%for (const m of messageData) {%>
                                    <div class="cell">
                                        <%- include("./partials/chatMessageCard",{chatID, messageID:m.message_id, senderID: m.sender_id, message:
                                        m.message, sentDateTime: m.sent_date_time, username: m.username, userID, senderRole: m.sender_role, }) %>
                                    </div>
                                    <%}%>
                                </div>
                            </div>
                        </section>
                        <section class="messaging mt-2">
                            <form action="/chats/<%= chatID %>" method="POST">
                                <input type="text" hidden value="<%= userID %>" name="senderID" />
                                <div class="field">
                                    <label class="label" for="message">Send a message:</label>
                                    <div class="control">
                                        <textarea class="textarea" placeholder="Write your message here" id="message" name="message"></textarea>
                                    </div>
                                </div>
                                <div class="field is-grouped">
                                    <div class="control">
                                        <button class="button is-link">Submit</button>
                                    </div>
                                </div>
                            </form>
                        </section>
                    </div>
                    <div class="column"></div>
                </div>
            </div>
        </main>
        <%- include("../partials/footer")%>
        <script
            type="module"
            src="/js/deleteContent.js"
            data-class-of-form-to-look-for="delete-message-form"
            data-class-of-element-to-hide="message-card"
        ></script>
        <script type="module" src="/js/chat/editMessage.js"></script>
        <script src="https://kit.fontawesome.com/fe51342540.js" crossorigin="anonymous"></script>
        <script src="/js/chat/dropdownToggle.js"></script>
    </body>
</html>

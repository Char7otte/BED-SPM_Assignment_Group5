<!DOCTYPE html>
<html lang="en">
<head>
    <%- include("../partials/head") %>
    <link rel="stylesheet" href="/css/calendar.css" type="text/css">
    <script src="/js/calendar.js" defer></script> <!-- moved here since it cannot load at the end of the <body> -->
    <title>Medical Appointment Calendar</title>
</head>
<body>
    <%- include("../partials/navbar") %>

    <header>
        <h1>Medical Appointment Calendar</h1>
    </header>

    <div id="main">
        <div id="appointments">
            <h1><strong>Medical Appointments on <span id="selected-date">the Calendar</span></strong></h1>
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Search appointments (title, doctor, location, notes...)">
                <button onclick="searchAppointments()">Search</button>
                <button onclick="clearSearch()">Clear</button>
            </div>

            <div class="month-year-controls">
                <div class="month-year-selectors">
                    <label for="month-select">Month:</label>
                    <select id="month-select"></select>
                    
                    <label for="year-select">Year:</label>
                    <select id="year-select"></select>
                    
                    <button onclick="viewAppointmentsByMonth()">View Month</button>
                </div>
                
                <div class="month-navigation" style="display: flex; justify-content: space-between;">
                    <button onclick="quickNavigateToMonth(-1)" title="Previous Month">‚Äπ Previous</button>
                    <button onclick="quickNavigateToMonth(1)" title="Next Month">Next ‚Ä∫</button>
                    
                </div>
            </div>
            
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <button onclick="renderAllAppointments()" style="background-color: #6c2fd3; color: white;">View All Appointments</button>
                <button onclick="openNewAppointment()" style="background: #2ecc71;">+ Add</button> 
            </div>
            
            <div id="monthly-appointments">
                <h3><span id="month-summary-label"></span></h3>
                <ul id="monthly-list"></ul>
            </div>

            <ul id="appointment-list"></ul>
        </div>

        <div id="calendar-container">
            <div id="calendar-header">
                <button onclick="changeMonth(-1)">‚Üê Previous Month</button>
                <span id="current-month">July 2025</span>
                <button onclick="changeMonth(1)">Next Month ‚Üí</button>
            </div>

            <div id="calendar"></div> <!-- Calendar grid goes here -->
        </div>
    </div>

    <div id="modal">
        <div class="modal-content">
            <h3>New Appointment</h3>
            <input type="date" id="appointment-date" placeholder="Date" min=""required>
            <input type="text" id="title" placeholder="Title" required>
            <input type="text" id="doctor" placeholder="Doctor" required>
            <input type="time" id="start-time" required>
            <input type="time" id="end-time" required>
            <input type="text" id="location" placeholder="Location" required>
            <textarea id="notes" placeholder="Notes" style="width: 100%; height: 100px; resize: vertical;"></textarea>
            <select id="status">
                <option value="Scheduled">üü¢ Scheduled</option>
                <option value="Ongoing">üü° Ongoing</option>
                <option value="Attended">‚úÖ Attended</option>
                <option value="Missed">üî¥ Missed</option>
            </select>


            <button onclick="saveAppointment()">Save</button>
            <button onclick="closeModal()">Cancel</button>
        </div>
    </div>

    <%- include("../partials/footer") %></body>
</html>
